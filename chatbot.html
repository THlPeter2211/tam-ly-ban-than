
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trò Chuyện với Chatbot Tâm Lý</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #a8dadc, #457b9d);
            color: #1d3557;
            margin: 0;
            padding: 0;
            min-height: 100vh;
            overflow-x: hidden;
        }
        .chat-container {
            max-width: 900px;
            margin: 20px auto;
            height: 80vh;
            display: flex;
            flex-direction: column;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        .chat-messages {
            flex-grow: 1;
            overflow-y: auto;
            padding: 20px;
            background: url('https://images.unsplash.com/photo-1600585154340-be6161a56a0c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1170&q=80') center/cover no-repeat, linear-gradient(to bottom, #f1faee, #e0f2f1);
            border-top-left-radius: 15px;
            border-top-right-radius: 15px;
        }
        .message {
            margin: 15px 0;
            padding: 15px;
            border-radius: 10px;
            max-width: 70%;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .user-message {
            background-color: #4caf50;
            color: white;
            margin-left: auto;
        }
        .bot-message {
            background-color: #e0e0e0;
            color: #333;
        }
        .chat-input {
            display: flex;
            padding: 15px;
            background-color: white;
            border-bottom-left-radius: 15px;
            border-bottom-right-radius: 15px;
            box-shadow: 0 -2px 5px rgba(0,0,0,0.1);
        }
        .chat-input input {
            flex-grow: 1;
            margin-right: 10px;
            border: 1px solid #ccc;
            border-radius: 50px;
            padding: 10px;
            font-size: 1rem;
        }
        .chat-input button {
            background-color: #4caf50;
            color: white;
            border: none;
            border-radius: 50px;
            padding: 10px 25px;
            font-weight: bold;
            transition: transform 0.3s;
        }
        .chat-input button:hover {
            transform: translateY(-2px);
        }
        .typing {
            font-style: italic;
            color: #666;
        }
        .error-message {
            color: red;
            text-align: center;
            padding: 10px;
        }
        nav {
            background: rgba(255,255,255,0.8);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .navbar-brand {
            font-size: 1.5rem;
            font-weight: 600;
        }
        .navbar-nav .nav-link {
            font-size: 1.1rem;
            margin-left: 15px;
            color: #1d3557 !important;
            transition: color 0.3s;
        }
        .navbar-nav .nav-link:hover {
            color: #4caf50 !important;
        }
        footer {
            background: rgba(29,53,87,0.8);
            color: white;
            padding: 20px 0;
            text-align: center;
            width: 100%;
            position: relative;
            bottom: 0;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg sticky-top">
        <div class="container">
            <a class="navbar-brand" href="index.html">Tâm Lý & Bản Thân</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html">Trang chủ</a></li>
                    <li class="nav-item"><a class="nav-link" href="journal.html">Nhật ký</a></li>
                    <li class="nav-item"><a class="nav-link" href="community.html">Cộng đồng</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Chat Section -->
    <section class="chat-container">
        <div class="chat-messages" id="chat-messages">
            <div class="bot-message">Xin chào! Tôi là người bạn tâm lý của bạn. Bạn đang cảm thấy thế nào hôm nay?</div>
        </div>
        <div class="chat-input">
            <input type="text" id="user-input" class="form-control" placeholder="Nhập tin nhắn...">
            <button id="send-button" class="btn">Gửi</button>
        </div>
    </section>

    <footer>
        <div class="container">
            <p>&copy; 2025 Dự án Tâm lý & Bản Thân.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        const chatMessages = document.getElementById('chat-messages');
        const userInput = document.getElementById('user-input');
        const sendButton = document.getElementById('send-button');
        let conversationHistory = [
            { role: "model", parts: [{ text: "Xin chào! Tôi là một bác sĩ tâm lý thân thiện, như một người bạn sẵn sàng lắng nghe và chia sẻ. Tôi sẽ trả lời gần gũi, tích cực, và hướng dẫn bạn đến suy nghĩ tích cực." }] }
        ];

        function addMessage(message, isUser = false) {
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('message', isUser ? 'user-message' : 'bot-message');
            messageDiv.textContent = message;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function showTyping() {
            const typingDiv = document.createElement('div');
            typingDiv.classList.add('message', 'bot-message', 'typing');
            typingDiv.textContent = 'Chatbot đang trả lời...';
            chatMessages.appendChild(typingDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            return typingDiv;
        }

        async function sendMessage(message) {
            addMessage(message, true);
            conversationHistory.push({ role: "user", parts: [{ text: message }] });
            userInput.value = '';
            const typingIndicator = showTyping();

            try {
                const response = await axios.post(
                    'https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=AIzaSyBoyxvpB0jl1a5lK-qVXAU-YFSXSlpujtI',
                    {
                        contents: conversationHistory
                    }
                );
                const reply = response.data.candidates[0].content.parts[0].text.trim();
                conversationHistory.push({ role: "model", parts: [{ text: reply }] });
                chatMessages.removeChild(typingIndicator);
                addMessage(reply);
            } catch (error) {
                chatMessages.removeChild(typingIndicator);
                addMessage('Xin lỗi, có lỗi xảy ra. Vui lòng thử lại!');
                console.error("Lỗi API:", error);
            }
        }

        sendButton.addEventListener('click', () => {
            const message = userInput.value.trim();
            if (message) sendMessage(message);
        });

        userInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && userInput.value.trim()) {
                sendMessage(userInput.value.trim());
            }
        });
    </script>
</body>
</html>


